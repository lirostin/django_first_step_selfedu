Механизм обработки запросов от пользователя
![[Pasted image 20220711201047.png]]
1. В блоке маршрутизации фиксируется тип URL-адреса и в списке предопределенных адресов ищется первое сопадение, если текущий запрос не совпал ни с одним предопределенным URL, то возвращается код ошибки  404
2. Когда маршрутизатор нашел совпадение, активизируется представление, связанное с найденным типом URL-адреса. **Представление или, его ещё называют контроллером** - это функция или класс, который отвечает за формирование ответа на соответствующий запрос (например HTML-страница).
3. Чтобы пользователь увидел страницу нужны данные + шаблоны в которые эти данные упаковываются.
   ![[Pasted image 20220711202053.png]]
   Именно такое разделение на данные(model), шаблоны (templates) и представления(views) образуют собой паттерн **MTV**

## Добавление первого приложения
В Django каждая самостоятельная часть сайта должна представляться в виде своего отдельного приожения
```shell
# создание первого приложения для отображения информации о знаменитых женщинах
python manage.py startapp women
```
Создаётся папка с файлами:
`_init_.py`
`migrations` для хранения миграций БД нашего приложения
`admin.py` - для настройки админ-панели
`apps.py` - для настройки (конфигурирования) текущего приложения
`models.py` - для хранения ORM-моделей для представления данных из базы данных
`test.py` - модуль с тестирующими процедурами
`views.py` - для хранения представлений (контроллеров) текущего приложения

1. После создания приложения его необходимо зарегистрировать в проекте нашего сатйа.
   `coolsite\coolsite\settings.py`
```python
INSTALLED_APPS = [
...
    'women.apps.WomenConfig',
]
```
### Представления и маршрутизация
создадим обработчик главной страницы сайта.  Для этого определим представление это страницы. Представление в Django можно реализовывать в виде функции или в виде класса.
`coolsite\women\views.py`
```python
from django.http import HttpResponse
from django.shortcuts import render

def index(request):
    return HttpResponse("Страница приложения women.")

def categories(request):
    return HttpResponse("<h1>Статьи по категориям</h1>")
```
`request` - ссылка на экземпляр класса HttpRequest, который содержит информацию о запросе, о сессии, о куках и т.д.
На выходе функция должна возвращать экземпляр объекта Httpresponse

Маршруты необходимо прописывать в самом приложение, а не в пакете конфигруации, т.к. это нарушает независимость приложения. Django позволяте вторым параметро вместо функции представлия передавать список URL-адресов приложения и связанные с ними функции. Для этого понадобиться специальная функция `include`
`coolsite\coolsite\urls.py`
```python
from women.views import *
from django.contrib import admin
from django.urls import path, include

urlpatterns = [
    path('admin/', admin.site.urls),
    path('women/', include('women.urls')),
]
```

После этого в приложение women добавляем новый файл urls.py и в нём формируем список urlpatterns
`coolsite\women\urls.py`
```python
from django.urls import path
from .views import *

urlpatterns = [
    path('', index),
    path('cats/', categories),
]
```